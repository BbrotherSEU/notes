
# 8 我是Makefile

 - make
    - make 会一次查找 GNUmakefile, makefile, Makefile 
        - 也可以使用 -f 指定一个工作文件
    - `-d` 参数用于调试 Makefile

## 8.2 基本概念

### 8.2.2 目标,条件和命令

```
# 目标 : 条件
#    命令
all: TinyEdit   

TinyEdit: main.o line.o ...
    ...
main.o : main.c line.h buffer.h tedef.h
    cc -c -o main.o main.c    
```


 - 目标可以作为参数，直接传给 make 
    - i.e. `make main.o`
    - 默认执行 make all

### 8.2.4 工作方式

 - 一个规模宏大的项目，比如 Linux 内核，源码文件数量数十万计，编译一次内核大概需要几十分钟甚至数小时
 - 如果每做一点修改，都要编译这么久，那简直就是灾难
 - make 解决这个问题的方法 就是哪个文件进行了修改 就只编译它
    - make 会依次把所有的目标，以及它们所对应的依赖， 进行时间戳(文件最后的修改时间)的对比。
    - 当发现某一个目标 比它的某些依赖的时间戳小的时候，就重新生成它。


### 8.2.5 基本语法

 - Makefile的基本语法是:

```
目标1 目标2 目标3 ... : 条件1 条件2 条件3 ...
    命令 1
    命令 2
    命令 3
    ...
```


 - 至少一个目标
 - 0个或 多个条件
    - 如果 没有给定条件， 只有 目标文件不存在时， 才会执行相应的命令去生成目标
 - 每个命令 必须以 制表符 `Tab` 开头
    - 如果在非命令行上不慎输入了 Tab的话，它之后的内容多数情况下会被当作命令来解释
 - 注释
    - `#` 开始的部分为注释
    - 不过切记 Tab的问题，  只要在 Tab后， 就会被作为命令解释， 包括 `#` 后面的内容
 - Makefile 支持 折行 
    - 在行尾 使用 `\` 


## 8.3 认识规则

### 8.3.3 变量

 - 现在需要给 生成的程序加入调试信息， 以便在发现bug


